import { Crypto, load, _, jinja2 } from './lib/cat.js';

let key = 'duboku';
let url = 'https://u.duboku.io';
let siteKey = '';
let siteType = 0;

const UA = 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1';

async function request(reqUrl, agentSp) {
    let res = await req(reqUrl, {
        method: 'get',
        headers: {
            'User-Agent': agentSp || UA,
            'Referer': url
        },
    });
    return res.content;
}

// cfg = {skey: siteKey, ext: extend}
async function init(cfg) {
    siteKey = cfg.skey;
    siteType = cfg.stype;
}

async function home(filter) {
    const html = await request(url);
    const $ = load(html);
    const class_parse = $('ul.nav-list > li > a[href*=vodtype]');
    let classes = [];
    classes = _.map(class_parse, (cls) => {
        let typeId = cls.attribs['href'];
        typeId = typeId.substring(typeId.lastIndexOf('/') + 1).replace('.html','');
        return {
            type_id: typeId,
            type_name: cls.children[0].data,
        };
    });
    let filterObj = {
		"2":[{"key":"cateId","name":"ç±»åž‹","value":[{"n":"å…¨éƒ¨","v":"2"},{"n":"é™†å‰§","v":"13"},{"n":"æ—¥éŸ©å‰§","v":"15"},{"n":"çŸ­å‰§","v":"21"},{"n":"å°æ³°å‰§","v":"14"},{"n":"æ¸¯å‰§","v":"20"}]},{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"æ‚¬ç–‘","v":"æ‚¬ç–‘"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"éƒ½å¸‚","v":"éƒ½å¸‚"},{"n":"çˆ±æƒ…","v":"çˆ±æƒ…"},{"n":"å¤è£…","v":"å¤è£…"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"é’æ˜¥","v":"é’æ˜¥"},{"n":"å¶åƒ","v":"å¶åƒ"},{"n":"å–œå‰§","v":"å–œå‰§"},{"n":"å®¶åº­","v":"å®¶åº­"},{"n":"çŠ¯ç½ª","v":"çŠ¯ç½ª"},{"n":"å¥‡å¹»","v":"å¥‡å¹»"},{"n":"å‰§æƒ…","v":"å‰§æƒ…"},{"n":"ä¹¡æ‘","v":"ä¹¡æ‘"},{"n":"å¹´ä»£","v":"å¹´ä»£"},{"n":"è­¦åŒª","v":"è­¦åŒª"},{"n":"è°æˆ˜","v":"è°æˆ˜"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"ç½ªæ¡ˆ","v":"ç½ªæ¡ˆ"},{"n":"å®«å»·","v":"å®«å»·"},{"n":"BL","v":"BL"}]},{"key":"area","name":"åœ°åŒº","value":[{"n":"å…¨éƒ¨","v":""},{"n":"ðŸ‡¨ðŸ‡³ä¸­å›½","v":"å†…åœ°"},{"n":"ðŸ‡°ðŸ‡·éŸ©å›½","v":"éŸ©å›½"},{"n":"ðŸ‡­ðŸ‡°é¦™æ¸¯","v":"é¦™æ¸¯"},{"n":"ðŸ‡¹ðŸ‡¼å°æ¹¾","v":"å°æ¹¾"},{"n":"ðŸ‡ºðŸ‡¸ç¾Žå›½","v":"ç¾Žå›½"},{"n":"è‹±å›½","v":"è‹±å›½"},{"n":"å·´è¥¿","v":"å·´è¥¿"},{"n":"æ³°å›½","v":"æ³°å›½"},{"n":"æ³•å›½","v":"æ³•å›½"},{"n":"ðŸ‡¯ðŸ‡µæ—¥æœ¬","v":"æ—¥æœ¬"},{"n":"è·å…°","v":"è·å…°"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"lang","name":"è¯­è¨€","value":[{"n":"å…¨éƒ¨","v":""},{"n":"å›½è¯­","v":"å›½è¯­"},{"n":"è‹±è¯­","v":"è‹±è¯­"},{"n":"ç²¤è¯­","v":"ç²¤è¯­"},{"n":"éŸ©è¯­","v":"éŸ©è¯­"},{"n":"æ³°è¯­","v":"æ³°è¯­"},{"n":"æ³•è¯­","v":"æ³•è¯­"},{"n":"æ—¥è¯­","v":"æ—¥è¯­"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"3":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"çœŸäººç§€","v":"çœŸäººç§€"},{"n":"é€‰ç§€","v":"é€‰ç§€"},{"n":"ç«žæ¼”","v":"ç«žæ¼”"},{"n":"æƒ…æ„Ÿ","v":"æƒ…æ„Ÿ"},{"n":"è®¿è°ˆ","v":"è®¿è°ˆ"},{"n":"æ’­æŠ¥","v":"æ’­æŠ¥"},{"n":"æ—…æ¸¸","v":"æ—…æ¸¸"},{"n":"éŸ³ä¹","v":"éŸ³ä¹"},{"n":"ç¾Žé£Ÿ","v":"ç¾Žé£Ÿ"},{"n":"çºªå®ž","v":"çºªå®ž"},{"n":"æ›²è‰º","v":"æ›²è‰º"},{"n":"ç”Ÿæ´»","v":"ç”Ÿæ´»"},{"n":"æ¸¸æˆäº’åŠ¨","v":"æ¸¸æˆäº’åŠ¨"}]},{"key":"area","name":"åœ°åŒº","value":[{"n":"å…¨éƒ¨","v":""},{"n":"ðŸ‡¨ðŸ‡³ä¸­å›½","v":"å†…åœ°"},{"n":"ðŸ‡­ðŸ‡°é¦™æ¸¯","v":"é¦™æ¸¯"},{"n":"ðŸ‡¹ðŸ‡¼å°æ¹¾","v":"å°æ¹¾"},{"n":"ðŸ‡°ðŸ‡·éŸ©å›½","v":"éŸ©å›½"},{"n":"ðŸ‡ºðŸ‡¸ç¾Žå›½","v":"ç¾Žå›½"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"}]},{"key":"lang","name":"è¯­è¨€","value":[{"n":"å…¨éƒ¨","v":""},{"n":"å›½è¯­","v":"å›½è¯­"},{"n":"è‹±è¯­","v":"è‹±è¯­"},{"n":"ç²¤è¯­","v":"ç²¤è¯­"},{"n":"é—½å—è¯­","v":"é—½å—è¯­"},{"n":"éŸ©è¯­","v":"éŸ©è¯­"},{"n":"æ—¥è¯­","v":"æ—¥è¯­"},{"n":"å…¶å®ƒ","v":"å…¶å®ƒ"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"4":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"çŽ„å¹»","v":"çŽ„å¹»"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"æƒ…æ„Ÿ","v":"æƒ…æ„Ÿ"},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"çƒ­è¡€","v":"çƒ­è¡€"},{"n":"æŽ¨ç†","v":"æŽ¨ç†"},{"n":"æžç¬‘","v":"æžç¬‘"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"èèŽ‰","v":"èèŽ‰"},{"n":"æ ¡å›­","v":"æ ¡å›­"},{"n":"åŠ¨ä½œ","v":"åŠ¨ä½œ"},{"n":"æœºæˆ˜","v":"æœºæˆ˜"},{"n":"è¿åŠ¨","v":"è¿åŠ¨"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"å°‘å¹´","v":"å°‘å¹´"},{"n":"å°‘å¥³","v":"å°‘å¥³"},{"n":"ç¤¾ä¼š","v":"ç¤¾ä¼š"},{"n":"äº²å­","v":"äº²å­"},{"n":"ç›Šæ™º","v":"ç›Šæ™º"},{"n":"åŠ±å¿—","v":"åŠ±å¿—"},{"n":"å…¶ä»–","v":"å…¶ä»–"}]},{"key":"area","name":"åœ°åŒº","value":[{"n":"å…¨éƒ¨","v":""},{"n":"å›½äº§","v":"å›½äº§"},{"n":"ðŸ‡¯ðŸ‡µæ—¥æœ¬","v":"æ—¥æœ¬"},{"n":"ðŸ‡ºðŸ‡¸ç¾Žå›½","v":"ç¾Žå›½"},{"n":"æ³•å›½","v":"æ³•å›½"},{"n":"å…¶ä»–","v":"å…¶ä»–"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"lang","name":"è¯­è¨€","value":[{"n":"å…¨éƒ¨","v":""},{"n":"å›½è¯­","v":"å›½è¯­"},{"n":"è‹±è¯­","v":"è‹±è¯­"},{"n":"ç²¤è¯­","v":"ç²¤è¯­"},{"n":"é—½å—è¯­","v":"é—½å—è¯­"},{"n":"éŸ©è¯­","v":"éŸ©è¯­"},{"n":"æ—¥è¯­","v":"æ—¥è¯­"},{"n":"å…¶å®ƒ","v":"å…¶å®ƒ"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"13":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"æ‚¬ç–‘","v":"æ‚¬ç–‘"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"éƒ½å¸‚","v":"éƒ½å¸‚"},{"n":"çˆ±æƒ…","v":"çˆ±æƒ…"},{"n":"å¤è£…","v":"å¤è£…"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"é’æ˜¥","v":"é’æ˜¥"},{"n":"å¶åƒ","v":"å¶åƒ"},{"n":"å–œå‰§","v":"å–œå‰§"},{"n":"å®¶åº­","v":"å®¶åº­"},{"n":"çŠ¯ç½ª","v":"çŠ¯ç½ª"},{"n":"å¥‡å¹»","v":"å¥‡å¹»"},{"n":"å‰§æƒ…","v":"å‰§æƒ…"},{"n":"ä¹¡æ‘","v":"ä¹¡æ‘"},{"n":"å¹´ä»£","v":"å¹´ä»£"},{"n":"è­¦åŒª","v":"è­¦åŒª"},{"n":"è°æˆ˜","v":"è°æˆ˜"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"ç½ªæ¡ˆ","v":"ç½ªæ¡ˆ"},{"n":"å®«å»·","v":"å®«å»·"},{"n":"BL","v":"BL"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"15":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"æ‚¬ç–‘","v":"æ‚¬ç–‘"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"éƒ½å¸‚","v":"éƒ½å¸‚"},{"n":"çˆ±æƒ…","v":"çˆ±æƒ…"},{"n":"å¤è£…","v":"å¤è£…"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"é’æ˜¥","v":"é’æ˜¥"},{"n":"å¶åƒ","v":"å¶åƒ"},{"n":"å–œå‰§","v":"å–œå‰§"},{"n":"å®¶åº­","v":"å®¶åº­"},{"n":"çŠ¯ç½ª","v":"çŠ¯ç½ª"},{"n":"å¥‡å¹»","v":"å¥‡å¹»"},{"n":"å‰§æƒ…","v":"å‰§æƒ…"},{"n":"ä¹¡æ‘","v":"ä¹¡æ‘"},{"n":"å¹´ä»£","v":"å¹´ä»£"},{"n":"è­¦åŒª","v":"è­¦åŒª"},{"n":"è°æˆ˜","v":"è°æˆ˜"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"ç½ªæ¡ˆ","v":"ç½ªæ¡ˆ"},{"n":"å®«å»·","v":"å®«å»·"},{"n":"BL","v":"BL"}]},{"key":"area","name":"åœ°åŒº","value":[{"n":"å…¨éƒ¨","v":""},{"n":"ðŸ‡°ðŸ‡·éŸ©å›½","v":"éŸ©å›½"},{"n":"ðŸ‡¯ðŸ‡µæ—¥æœ¬","v":"æ—¥æœ¬"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"21":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"æ‚¬ç–‘","v":"æ‚¬ç–‘"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"éƒ½å¸‚","v":"éƒ½å¸‚"},{"n":"çˆ±æƒ…","v":"çˆ±æƒ…"},{"n":"å¤è£…","v":"å¤è£…"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"é’æ˜¥","v":"é’æ˜¥"},{"n":"å¶åƒ","v":"å¶åƒ"},{"n":"å–œå‰§","v":"å–œå‰§"},{"n":"å®¶åº­","v":"å®¶åº­"},{"n":"çŠ¯ç½ª","v":"çŠ¯ç½ª"},{"n":"å¥‡å¹»","v":"å¥‡å¹»"},{"n":"å‰§æƒ…","v":"å‰§æƒ…"},{"n":"ä¹¡æ‘","v":"ä¹¡æ‘"},{"n":"å¹´ä»£","v":"å¹´ä»£"},{"n":"è­¦åŒª","v":"è­¦åŒª"},{"n":"è°æˆ˜","v":"è°æˆ˜"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"ç½ªæ¡ˆ","v":"ç½ªæ¡ˆ"},{"n":"å®«å»·","v":"å®«å»·"},{"n":"BL","v":"BL"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"14":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"æ‚¬ç–‘","v":"æ‚¬ç–‘"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"éƒ½å¸‚","v":"éƒ½å¸‚"},{"n":"çˆ±æƒ…","v":"çˆ±æƒ…"},{"n":"å¤è£…","v":"å¤è£…"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"é’æ˜¥","v":"é’æ˜¥"},{"n":"å¶åƒ","v":"å¶åƒ"},{"n":"å–œå‰§","v":"å–œå‰§"},{"n":"å®¶åº­","v":"å®¶åº­"},{"n":"çŠ¯ç½ª","v":"çŠ¯ç½ª"},{"n":"å¥‡å¹»","v":"å¥‡å¹»"},{"n":"å‰§æƒ…","v":"å‰§æƒ…"},{"n":"ä¹¡æ‘","v":"ä¹¡æ‘"},{"n":"å¹´ä»£","v":"å¹´ä»£"},{"n":"è­¦åŒª","v":"è­¦åŒª"},{"n":"è°æˆ˜","v":"è°æˆ˜"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"ç½ªæ¡ˆ","v":"ç½ªæ¡ˆ"},{"n":"å®«å»·","v":"å®«å»·"},{"n":"BL","v":"BL"}]},{"key":"area","name":"åœ°åŒº","value":[{"n":"å…¨éƒ¨","v":""},{"n":"ðŸ‡¹ðŸ‡¼å°æ¹¾","v":"å°æ¹¾"},{"n":"æ³°å›½","v":"æ³°å›½"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}],
		"20":[{"key":"class","name":"å‰§æƒ…","value":[{"n":"å…¨éƒ¨","v":""},{"n":"æ‚¬ç–‘","v":"æ‚¬ç–‘"},{"n":"æ­¦ä¾ ","v":"æ­¦ä¾ "},{"n":"ç§‘å¹»","v":"ç§‘å¹»"},{"n":"éƒ½å¸‚","v":"éƒ½å¸‚"},{"n":"çˆ±æƒ…","v":"çˆ±æƒ…"},{"n":"å¤è£…","v":"å¤è£…"},{"n":"æˆ˜äº‰","v":"æˆ˜äº‰"},{"n":"é’æ˜¥","v":"é’æ˜¥"},{"n":"å¶åƒ","v":"å¶åƒ"},{"n":"å–œå‰§","v":"å–œå‰§"},{"n":"å®¶åº­","v":"å®¶åº­"},{"n":"çŠ¯ç½ª","v":"çŠ¯ç½ª"},{"n":"å¥‡å¹»","v":"å¥‡å¹»"},{"n":"å‰§æƒ…","v":"å‰§æƒ…"},{"n":"ä¹¡æ‘","v":"ä¹¡æ‘"},{"n":"å¹´ä»£","v":"å¹´ä»£"},{"n":"è­¦åŒª","v":"è­¦åŒª"},{"n":"è°æˆ˜","v":"è°æˆ˜"},{"n":"å†’é™©","v":"å†’é™©"},{"n":"ç½ªæ¡ˆ","v":"ç½ªæ¡ˆ"},{"n":"å®«å»·","v":"å®«å»·"},{"n":"BL","v":"BL"}]},{"key":"year","name":"å¹´ä»½","value":[{"n":"å…¨éƒ¨","v":""},{"n":"2023","v":"2023"},{"n":"2022","v":"2022"},{"n":"2021","v":"2021"},{"n":"2020","v":"2020"},{"n":"2019","v":"2019"},{"n":"2018","v":"2018"},{"n":"2017","v":"2017"}]},{"key":"letter","name":"å­—æ¯","value":[{"n":"å…¨éƒ¨","v":""},{"n":"A","v":"A"},{"n":"B","v":"B"},{"n":"C","v":"C"},{"n":"D","v":"D"},{"n":"E","v":"E"},{"n":"F","v":"F"},{"n":"G","v":"G"},{"n":"H","v":"H"},{"n":"I","v":"I"},{"n":"J","v":"J"},{"n":"K","v":"K"},{"n":"L","v":"L"},{"n":"M","v":"M"},{"n":"N","v":"N"},{"n":"O","v":"O"},{"n":"P","v":"P"},{"n":"Q","v":"Q"},{"n":"R","v":"R"},{"n":"S","v":"S"},{"n":"T","v":"T"},{"n":"U","v":"U"},{"n":"V","v":"V"},{"n":"W","v":"W"},{"n":"X","v":"X"},{"n":"Y","v":"Y"},{"n":"Z","v":"Z"}]},{"key":"by","name":"æŽ’åº","value":[{"n":"æ—¶é—´","v":"time"},{"n":"äººæ°”","v":"hits"},{"n":"è¯„åˆ†","v":"score"}]}]
	};

    return JSON.stringify({
        class: classes,
        filters: filterObj,
    });
}

async function homeVod() {
    const link = url + '/vodshow/2--hits---------.html';
    const html = await request(link);
    const $ = load(html);
    const items = $('div.myui-panel_bd > ul.myui-vodlist > li');
    let videos = _.map(items, (item) => {
        const it = $(item).find('a:first')[0];
        const remarks = $($(item).find('span.pic-text')[0]).text().trim();
        return {
            vod_id: it.attribs.href.replace(/.*?\/voddetail\/(.*).html/g, '$1'),
            vod_name: it.attribs.title,
            vod_pic: it.attribs['data-original'],
            vod_remarks: remarks || '',
        };
    });
    return JSON.stringify({
        list: videos,
    });
}

async function category(tid, pg, filter, extend) {
    if (pg <= 0) pg = 1;

    const link = url + '/vodshow/' + (extend.CateId || tid) + '-'+(extend.area || '')+'-'+(extend.by || 'time')+'-'+(extend.class || '')+'-'+(extend.lang || '')+'-'+(extend.letter || '')+'---' + (`${pg}`) + '---'+(extend.year || '')+'.html';
    const html = await request(link);
    const $ = load(html);
    const items = $('div.myui-panel_bd > ul.myui-vodlist > li');
    let videos = _.map(items, (item) => {
        const it = $(item).find('a:first')[0];
        const remarks = $($(item).find('span.pic-text')[0]).text().trim();
        return {
            vod_id: it.attribs.href.replace(/.*?\/voddetail\/(.*).html/g, '$1'),
            vod_name: it.attribs.title,
            vod_pic: it.attribs['data-original'],
            vod_remarks: remarks || '',
        };
    });
    const hasMore = $('ul.myui-page > li > a:contains(ä¸‹ä¸€é¡µ)').length > 0;
    const pgCount = hasMore ? parseInt(pg) + 1 : parseInt(pg);
    return JSON.stringify({
        page: parseInt(pg),
        pagecount: pgCount,
        limit: 24,
        total: 24 * pgCount,
        list: videos,
    });
}

async function detail(id) {
    const html = await request(url + '/voddetail/' + id + '.html');
    const $ = load(html);
    let vod = {
        vod_id: id,
        vod_name: $('h1:first').text().trim(),
        vod_type: $('.myui-content__detail p:first a').text(),
        vod_actor: $('.myui-content__detail p:nth-child(5)').text().replace('ä¸»æ¼”ï¼š',''),
        vod_director: $('.myui-content__detail p:nth-child(6)').text().replace('å¯¼æ¼”ï¼š',''),
        vod_pic: $('div.myui-content__thumb img:first').attr('data-original'),
        vod_remarks :$('#rating:first span').text().replace(/\s{2,}/g, ' '),
        vod_content: $('span.data').text().trim(),
    };
    const playlist = _.map($('ul.sort-list > li > a'), (it) => {
        return it.children[0].data + '$' + it.attribs.href.replace(/\/vodplay\/(.*).html/g, '$1');
    });
    vod.vod_play_from = key;
    vod.vod_play_url = playlist.join('#');
    return JSON.stringify({
        list: [vod],
    });
}

async function play(flag, id, flags) {
    const link = url + '/vodplay/' + id + '.html';
    const html = await request(link);
    const $ = load(html);
    const js = JSON.parse($('script:contains(player_)').html().replace('var player_data=',''));
    const playUrl = js.url.replace('index.m3u8','hls\/index.m3u8');
    return JSON.stringify({
        parse: 0,
        url: playUrl,
    });
}

async function search(wd, quick) {
    let data = JSON.parse(await request(url + '/index.php/ajax/suggest?mid=1&wd=' + wd)).list;
    let videos = [];
    for (const vod of data) {
        videos.push({
            vod_id: vod.id,
            vod_name: vod.name,
            vod_pic: vod.pic,
            vod_remarks: '',
        });
    }
    return JSON.stringify({
        list: videos,
    });
}

export function __jsEvalReturn() {
    return {
        init: init,
        home: home,
        homeVod: homeVod,
        category: category,
        detail: detail,
        play: play,
        search: search,
    };
}